<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="keywords" content="周硕的博客, 前端博客">
  <meta name="description" content="周硕的个人博客，此博客是我记录工作和学习的地方。">
  <title>为博客添加Gitalk评论插件 | 周硕的博客</title>
  
  
  <link rel="shortcut icon" href="/blog/assets/favicon.ico" >
  
  <link rel="stylesheet" href="/blog/css/highlight_themes/tomorrow.css">
  
  <link rel="stylesheet" href="/css/style.css">
  
  <!-- global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-111550549-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111550549-1');
</script>


  
</head>

<body>
<div class="Shell">
    <aside class='SideBar'>
    <section class='avatar' style="background: #333 url(/assets/header-bg2.jpg) no-repeat center; background-size:cover;">
        <div class='av-pic' style="background-image: url(/assets/logo.jpg)">
        </div>
    </section>
    <section class='menu'>
        <div>周硕的博客</div>
        
        <ul>
          
            <a href="/" class="Btn">
              <li>Home</li>
            </a>  
          
            <a href="/archives/" class="Btn">
              <li>Archive</li>
            </a>  
          
            <a href="/tags/" class="Btn">
              <li>Tags</li>
            </a>  
          
            <a href="/about/" class="Btn">
              <li>About</li>
            </a>  
          
        </ul>
    </section>
    <section class="media">
        
            
                <a href="https://github.com/zhoushuozh/">
                    <img src="/blog/assets/github.svg" />
                </a>
            
        
            
                <a href="https://weibo.com/zhoushuozh/">
                    <img src="/blog/assets/weibo.svg" />
                </a>
            
        
    </section>
</aside>

    <div class="container">
        <div data-pager-shell>
            <div>
  <article class='ContentView'>
    <header class='PageTitle'>
        <h1>为博客添加Gitalk评论插件</h1>
    </header>

    <section>
      <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前体验过畅言、来必力、gitalk等评论插件，体验最好的就是gitalk了。我目前用的<code>icalm</code>主题内置了 <a href="http://disqus.com/" target="_blank" rel="noopener">Disqus</a>评论插件，用着还行，但在国内的加载速度那个惨啊… 所以决定还是换回gitalk。</p>
<a id="more"></a>
<h2 id="关于Gitalk"><a href="#关于Gitalk" class="headerlink" title="关于Gitalk"></a>关于Gitalk</h2><p>Gitalk 是一个基于 Github Issue 和 Preact 开发的评论插件。使用 Github 帐号登录，界面干净整洁，最喜欢的一点是支持 MarkDown语法</p>
<p>主要特性：</p>
<ul>
<li>使用 Github 登录</li>
<li>支持多语言 [en, zh-CN, zh-TW, es-ES, fr]</li>
<li>支持个人或组织</li>
<li>无干扰模式（设置 distractionFreeMode 为 true 开启）</li>
<li>快捷键提交评论 （cmd|ctrl + enter）</li>
<li>支持MarkDown语法</li>
</ul>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><a href="https://link.jianshu.com/?t=https://github.com/gitalk/gitalk" target="_blank" rel="noopener">Gitalk</a>提供了两种方式：</p>
<ul>
<li>直接引入</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://unpkg.com/gitalk/dist/gitalk.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/gitalk/dist/gitalk.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>npm 安装</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> npm i --save gitalk</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'gitalk/dist/gitalk.css'</span></span><br><span class="line"><span class="keyword">import</span> Gitalk <span class="keyword">from</span> <span class="string">'gitalk'</span></span><br></pre></td></tr></table></figure>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="新建仓库"><a href="#新建仓库" class="headerlink" title="新建仓库"></a>新建仓库</h3><p>Github上新建一个仓库，操作简单，这里就不废话了。</p>
<h3 id="创建OAuth-Application"><a href="#创建OAuth-Application" class="headerlink" title="创建OAuth Application"></a>创建OAuth Application</h3><p>Gitalk 需要一个 Github Application，<a href="https://github.com/settings/applications/new" target="_blank" rel="noopener">点击这里申请</a>。当然，也可以在用户头像下的setting下的Developer settings中new一个Application，然后填写相应的参数。</p>
<p><img src="https://cdn.zhoushuo.me/gitalk-app.png" alt="OAuth Application"></p>
<p>完成后会生成相应的<code>clientID</code>and<code>clientSecret</code>。</p>
<h2 id="集成-Gitalk"><a href="#集成-Gitalk" class="headerlink" title="集成 Gitalk"></a>集成 Gitalk</h2><p>找到<code>icalm/layout/_partial/comment.ejs</code>文件，把这段代码粘进去。注意，不同的主题方式不太一样。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://unpkg.com/gitalk/dist/gitalk.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"gitalk-container"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/gitalk/dist/gitalk.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> gitalk = <span class="keyword">new</span> Gitalk(&#123;</span></span><br><span class="line"><span class="javascript">        clientID: <span class="string">'&lt;%= theme.gitalk.clientID %&gt;'</span>,</span></span><br><span class="line"><span class="javascript">        clientSecret: <span class="string">'&lt;%= theme.gitalk.clientSecret %&gt;'</span>,</span></span><br><span class="line"><span class="javascript">        id: <span class="built_in">window</span>.location.pathname,</span></span><br><span class="line"><span class="javascript">        repo: <span class="string">'&lt;%= theme.gitalk.repo %&gt;'</span>,</span></span><br><span class="line"><span class="javascript">        owner: <span class="string">'&lt;%= theme.gitalk.owner %&gt;'</span>,</span></span><br><span class="line"><span class="javascript">        admin: <span class="string">'&lt;%= theme.gitalk.admin %&gt;'</span></span></span><br><span class="line"><span class="undefined">    &#125;)</span></span><br><span class="line"><span class="javascript">    gitalk.render(<span class="string">'gitalk-container'</span>)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>修改主题配置文件<code>icalm/_config.yml</code>中增加以下内容。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span>gitalk settings</span><br><span class="line">gitalk:</span><br><span class="line">  enable: true #用来做启用判断可以不用</span><br><span class="line">  owner: #Github 用户名,</span><br><span class="line">  repo: #储存评论issue的github仓库名</span><br><span class="line">  admin: #Github 用户名,</span><br><span class="line">  clientID: #`Github Application clientID`</span><br><span class="line">  clientSecret: #`Github Application clientSecret`</span><br></pre></td></tr></table></figure>
<p>在<code>../post.ejs</code>文件末尾添加 ：（<code>post.ejs</code>是我的文章模板，大家根据自己的需求添加就行）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% elseif theme.gitalk.enable %&#125;</span><br><span class="line">true&lt;%- partial(<span class="string">'_partial/comment'</span>) %&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>到这里基本就大功告成了，没什么问题的话，当你点击进入你的博客页面后就会出现评论框了。</p>
<p>当你用 github 帐号登录（管理员），并且第一次加载该会比较慢，因为第一次加载会自动在你 <code>repo</code>的仓库下创建对应 issue。</p>


      

    </section>
    
      <section class='ArticleMeta'>
          <div>
            发布于&nbsp;
            <time datetime="2018-03-21T18:32:49.000Z" itemprop="datePublished">
              2018-03-22
            </time>
          </div>
          
            <div>
              tags: 
  <li class="meta-text">
  { <a href="/tags/Gitalk/">Gitalk</a> }
  </li>

  <li class="meta-text">
  { <a href="/tags/MarkDown/">MarkDown</a> }
  </li>

  <li class="meta-text">
  { <a href="/tags/Hexo/">Hexo</a> }
  </li>


            </div>
          
      </section>
    
     
</article>

  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<div id="gitalk-container"></div>
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
        clientID: 'd50f82d1de5ab2dd34c6',
        clientSecret: '7ed79e0b3ad122582d5c8d7d5a295c1142743477',
        id: window.location.pathname,
        repo: 'comments',
        owner: 'zhoushuozh',
        admin: 'zhoushuozh'
    })
    gitalk.render('gitalk-container')
</script>

</div>

            <footer>
    <div>&copy; 2018 - 周硕 </div>
    <div>
    Powered by Hexo &nbsp; Theme icalm
    </div>
</footer>

        </div>
    </div>
</div>
<script src="/js/pager/dist/singlepager.js"></script>
<!--<script>
var sp = new Pager('data-pager-shell')
</script>-->

<!-- <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>-->


<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


</body>
</html>
