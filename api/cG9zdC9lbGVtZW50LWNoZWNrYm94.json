{"title":"element-ui的checkbox-group的问题","date":"2018-10-11T11:37:41.000Z","slug":"element-checkbox","comments":true,"tags":["Element-ui","Vue"],"categories":["前端"],"updated":"2019-01-21T02:15:33.218Z","content":"<p>说一个今天在工作中遇到的问题，element-ui中复选框组在重新赋值后无法勾选。</p>\n<a id=\"more\"></a>\n<p>先简单说一下<code>checkbox-group</code>的用法。element 中<code>checkbox-group</code>元素能把多个 checkbox 管理为一组，只需要在 Group 中使用<code>v-model</code>绑定<code>Array</code>类型的变量即可。<code>el-checkbox</code>的 <code>label</code>属性与数组中的元素值相对应，如果存在指定的值则为选中状态，否则为不选中。 </p>\n<p><strong>下面说一下我遇到的问题：</strong></p>\n<p>页面中有一组复选框，<code>v-model</code>绑定数据<code>form.checkList</code>，<code>form.checkList</code>初始为空数组，然后通过<code>ajax</code>请求数据，将请求到的数据赋给<code>form</code>。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">  &lt;el-checkbox-group v-model=<span class=\"string\">\"form.checkList\"</span>&gt;</span><br><span class=\"line\">    &lt;el-checkbox label=<span class=\"string\">\"r\"</span>&gt;读取&lt;<span class=\"regexp\">/el-checkbox&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;el-checkbox label=\"w\"&gt;写入&lt;/</span>el-checkbox&gt;</span><br><span class=\"line\">    &lt;el-checkbox label=<span class=\"string\">\"d\"</span>&gt;删除&lt;<span class=\"regexp\">/el-checkbox&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">  &lt;/</span>el-checkbox-group&gt;</span><br><span class=\"line\">&lt;<span class=\"regexp\">/template&gt;</span></span><br><span class=\"line\"><span class=\"regexp\"></span></span><br><span class=\"line\"><span class=\"regexp\">&lt;script&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">export default &#123;</span></span><br><span class=\"line\"><span class=\"regexp\">  data() &#123;</span></span><br><span class=\"line\"><span class=\"regexp\">    return &#123;</span></span><br><span class=\"line\"><span class=\"regexp\">      form: &#123;</span></span><br><span class=\"line\"><span class=\"regexp\">\t\tcheckList: []</span></span><br><span class=\"line\"><span class=\"regexp\">      &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">    &#125;</span></span><br><span class=\"line\"><span class=\"regexp\">  &#125;,</span></span><br><span class=\"line\"><span class=\"regexp\">  methods() &#123;</span></span><br><span class=\"line\"><span class=\"regexp\">    getData() &#123;</span></span><br><span class=\"line\"><span class=\"regexp\">      this.axios.post('/</span>data<span class=\"string\">')</span></span><br><span class=\"line\"><span class=\"string\">        .then((res) =&gt; &#123;</span></span><br><span class=\"line\"><span class=\"string\">          if(res.status === 1)&#123;</span></span><br><span class=\"line\"><span class=\"string\">            //res.data == &#123;checkList: ['</span>r<span class=\"string\">','</span>w<span class=\"string\">']&#125;</span></span><br><span class=\"line\"><span class=\"string\">            this.form = res.data  </span></span><br><span class=\"line\"><span class=\"string\">          &#125;</span></span><br><span class=\"line\"><span class=\"string\">        &#125;)</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\">  &#125;</span></span><br><span class=\"line\"><span class=\"string\">&#125;;</span></span><br><span class=\"line\"><span class=\"string\">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>\n<p>这时候就会发现，复选框不能操作了，既不能勾选也不能取消。</p>\n<p>先把赋值前和赋值的<code>checkList</code>打出来看一下：</p>\n<div class=\"article-img\"><p><img src=\"https://cdn.zhoushuo.me/blogelement-checkbox.png\" alt=\"截图\"></p></div>\n<p>可以看出来，赋值之后的数组没有<code>Observer</code>这个属性，这时候<code>checkbox</code>组件是无法监听<code>data</code>对象数据变化的。</p>\n<p><strong>解决办法：</strong></p>\n<p>可以通过<code>watch</code>计算属性来改变<code>data</code>值：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span><br><span class=\"line\">  data() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">      form: &#123;&#125;,</span><br><span class=\"line\">      form_1: &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  watch: &#123;</span><br><span class=\"line\">    form_1: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">val</span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.form = val</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  methods() &#123;</span><br><span class=\"line\">    getData() &#123;</span><br><span class=\"line\">      <span class=\"keyword\">this</span>.axios.post(<span class=\"string\">'/data'</span>)</span><br><span class=\"line\">        .then(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span>(res.status === <span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//res.data == &#123;checkList: ['r','w']&#125;</span></span><br><span class=\"line\">            <span class=\"keyword\">this</span>.form_1 = res.data</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">&lt;<span class=\"regexp\">/script&gt;</span></span><br></pre></td></tr></table></figure>\n<p>此外，如果不是依赖ajax的话，可用<code>mounted</code>，<code>watch</code>来改变<code>data</code>值</p>\n","next":{"title":"Vue组件间的通信","slug":"vue-component-communication"},"link":"https://blog.zhoushuo.me/post/element-checkbox/","copyright":{"author":"zhoushuo","link":"<a href=\"https://blog.zhoushuo.me/post/element-checkbox/\" title=\"element-ui的checkbox-group的问题\">https://blog.zhoushuo.me/post/element-checkbox/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow noopener\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)","published":"2018年10月11日"}}