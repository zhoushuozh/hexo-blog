{"title":"为博客添加Gitalk评论插件","date":"2018-03-21T18:32:49.000Z","link":"post/hexo-gitalk","comments":true,"tags":["Gitalk","Hexo"],"categories":["未分类"],"updated":"2020-07-14T10:49:39.118Z","content":"<p>之前体验过畅言、来必力、gitalk等评论插件，体验最好的就是gitalk了。我目前用的<code>icalm</code>主题内置了 <a href=\"http://disqus.com/\" target=\"_blank\" rel=\"noopener\">Disqus</a>评论插件，用着还行，但在国内的加载速度那个惨啊… 所以决定还是换回gitalk。</p>\n<a id=\"more\"></a>\n<h2 id=\"关于Gitalk\">关于Gitalk<a href=\"post/hexo-gitalk#关于Gitalk\"></a></h2><p>Gitalk 是一个基于 Github Issue 和 Preact 开发的评论插件。使用 Github 帐号登录，界面干净整洁，最喜欢的一点是支持 MarkDown语法</p>\n<p>主要特性：</p>\n<ul>\n<li>使用 Github 登录</li>\n<li>支持多语言 [en, zh-CN, zh-TW, es-ES, fr]</li>\n<li>支持个人或组织</li>\n<li>无干扰模式（设置 distractionFreeMode 为 true 开启）</li>\n<li>快捷键提交评论 （cmd|ctrl + enter）</li>\n<li>支持MarkDown语法</li>\n</ul>\n<h2 id=\"安装\">安装<a href=\"post/hexo-gitalk#安装\"></a></h2><p><a href=\"https://link.jianshu.com/?t=https://github.com/gitalk/gitalk\" target=\"_blank\" rel=\"noopener\">Gitalk</a>提供了两种方式：</p>\n<ul>\n<li>直接引入</li>\n</ul>\n<figure class=\"highlight html\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://unpkg.com/gitalk/dist/gitalk.css\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://unpkg.com/gitalk/dist/gitalk.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<ul>\n<li>npm 安装</li>\n</ul>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span> npm i --save gitalk</span><br></pre></td></tr></table></div></figure>\n<figure class=\"highlight js\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">'gitalk/dist/gitalk.css'</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> Gitalk <span class=\"keyword\">from</span> <span class=\"string\">'gitalk'</span></span><br></pre></td></tr></table></div></figure>\n<h2 id=\"使用\">使用<a href=\"post/hexo-gitalk#使用\"></a></h2><h3 id=\"新建仓库\">新建仓库<a href=\"post/hexo-gitalk#新建仓库\"></a></h3><p>Github上新建一个仓库，操作简单，这里就不废话了。</p>\n<h2 id=\"创建OAuth-Application\">创建OAuth Application<a href=\"post/hexo-gitalk#创建OAuth-Application\"></a></h2><p>Gitalk 需要一个 Github Application，<a href=\"https://github.com/settings/applications/new\" target=\"_blank\" rel=\"noopener\">点击这里申请</a>。当然，也可以在用户头像下的setting下的Developer settings中new一个Application，然后填写相应的参数。</p>\n<p><img src=\"https://cdn.zhoushuo.vip/gitalk-app.png\" alt=\"OAuth Application\" class=\"article-img\"></p>\n<p>完成后会生成相应的<code>clientID</code>and<code>clientSecret</code>。</p>\n<h2 id=\"集成-Gitalk\">集成 Gitalk<a href=\"post/hexo-gitalk#集成-Gitalk\"></a></h2><p>找到<code>icalm/layout/_partial/comment.ejs</code>文件，把这段代码粘进去。注意，不同的主题方式不太一样。</p>\n<figure class=\"highlight html\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://unpkg.com/gitalk/dist/gitalk.css\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"gitalk-container\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://unpkg.com/gitalk/dist/gitalk.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">var</span> gitalk = <span class=\"keyword\">new</span> Gitalk(&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">        clientID: <span class=\"string\">'&lt;%= theme.gitalk.clientID %&gt;'</span>,</span></span><br><span class=\"line\"><span class=\"javascript\">        clientSecret: <span class=\"string\">'&lt;%= theme.gitalk.clientSecret %&gt;'</span>,</span></span><br><span class=\"line\"><span class=\"javascript\">        id: <span class=\"built_in\">window</span>.location.pathname,</span></span><br><span class=\"line\"><span class=\"javascript\">        repo: <span class=\"string\">'&lt;%= theme.gitalk.repo %&gt;'</span>,</span></span><br><span class=\"line\"><span class=\"javascript\">        owner: <span class=\"string\">'&lt;%= theme.gitalk.owner %&gt;'</span>,</span></span><br><span class=\"line\"><span class=\"javascript\">        admin: <span class=\"string\">'&lt;%= theme.gitalk.admin %&gt;'</span></span></span><br><span class=\"line\"><span class=\"undefined\">    &#125;)</span></span><br><span class=\"line\"><span class=\"javascript\">    gitalk.render(<span class=\"string\">'gitalk-container'</span>)</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n<p>修改主题配置文件<code>icalm/_config.yml</code>中增加以下内容。</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>gitalk settings</span><br><span class=\"line\">gitalk:</span><br><span class=\"line\">  enable: true #用来做启用判断可以不用</span><br><span class=\"line\">  owner: #Github 用户名,</span><br><span class=\"line\">  repo: #储存评论issue的github仓库名</span><br><span class=\"line\">  admin: #Github 用户名,</span><br><span class=\"line\">  clientID: #`Github Application clientID`</span><br><span class=\"line\">  clientSecret: #`Github Application clientSecret`</span><br></pre></td></tr></table></div></figure>\n<p>在<code>../post.ejs</code>文件末尾添加 ：（<code>post.ejs</code>是我的文章模板，大家根据自己的需求添加就行）</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% elseif theme.gitalk.enable %&#125;</span><br><span class=\"line\">true&lt;%- partial(<span class=\"string\">'_partial/comment'</span>) %&gt;</span><br><span class=\"line\">&#123;% endif %&#125;</span><br></pre></td></tr></table></div></figure>\n<h2 id=\"小结\">小结<a href=\"post/hexo-gitalk#小结\"></a></h2><p>到这里基本就大功告成了，没什么问题的话，当你点击进入你的博客页面后就会出现评论框了。</p>\n<p>当你用 github 帐号登录（管理员），并且第一次加载该会比较慢，因为第一次加载会自动在你 <code>repo</code>的仓库下创建对应 issue。</p>\n","prev":{"title":"JavaScript常见原生DOM操作API总结","link":"post/dom-api"},"next":{"title":"博客从Firekylin迁移到Hexo","link":"post/firekylin-hexo"},"plink":"https://blog.zhoushuo.me/post/hexo-gitalk/","toc":[{"title":"关于Gitalk","id":"关于Gitalk","index":"1"},{"title":"安装","id":"安装","index":"2"},{"title":"使用","id":"使用","index":"3","children":[{"title":"新建仓库","id":"新建仓库","index":"3.1"}]},{"title":"创建OAuth Application","id":"创建OAuth-Application","index":"4"},{"title":"集成 Gitalk","id":"集成-Gitalk","index":"5"},{"title":"小结","id":"小结","index":"6"}],"copyright":{"author":"zhoushuo","link":"<a href=\"https://blog.zhoushuo.me/post/hexo-gitalk/\" title=\"为博客添加Gitalk评论插件\">https://blog.zhoushuo.me/post/hexo-gitalk/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"}}